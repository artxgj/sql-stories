# Highs, Lows, Averages And Other Contrived Stock-related Queries #

This is my SQL tutorial-by-examples (contrived examples). I cover subqueries, aggregation, common table expression, window functions and materialized views.

## The Arbitrary Prime Number Stock Index (APNSI) ##

```SQL
SELECT t.id as ticker_id, t.symbol AS ticker_symbol, t.exchange AS exchange_id, e.abbr AS exchange
FROM
  stock.ticker t
    INNER JOIN
  stock.exchange e ON t.exchange=e.id
ORDER BY ticker_symbol;
```
The APNSI has 17 stocks.

| ticker_id | ticker_symbol | exchange_id | exchange |
|:----------|:--------------|:------------|:---------|
| 20        | AAPL          | 2           | NASDAQ   |
| 25        | AMD           | 2           | NASDAQ   |
| 29        | AMZN          | 2           | NASDAQ   |
| 33        | BABA          | 1           | NYSE     |
| 21        | COST          | 2           | NASDAQ   |
| 26        | DPZ           | 1           | NYSE     |
| 30        | FB            | 2           | NASDAQ   |
| 34        | GOOG          | 2           | NASDAQ   |
| 22        | INTC          | 2           | NASDAQ   |
| 27        | KO            | 1           | NYSE     |
| 31        | MSFT          | 2           | NASDAQ   |
| 35        | NFLX          | 2           | NASDAQ   |
| 23        | NKE           | 1           | NYSE     |
| 28        | NVDA          | 2           | NASDAQ   |
| 32        | PEP           | 1           | NYSE     |
| 36        | WFM           | 2           | NASDAQ   |
| 24        | WMT           | 1           | NYSE     |

## June 2017 average closing price (rounded to 2 decimal places) of each   APNSI stock ##

```SQL
SELECT t.symbol, round(jun.avg_close, 2) as avg_close_201706
FROM
  stock.ticker t
    INNER JOIN
  (
    SELECT h.ticker, AVG(h.close) as avg_close
    FROM
      stock.historical_data h
    WHERE
      h.date BETWEEN '2017-06-01' AND '2017-06-30'
    GROUP BY h.ticker
  ) jun ON t.id = jun.ticker
ORDER by t.symbol;
```
| symbol | avg_close_201706 |
|:-------|:-----------------|
| AAPL   | 147.83           |
| AMD    | 12.47            |
| AMZN   | 990.44           |
| BABA   | 136.55           |
| COST   | 171.08           |
| DPZ    | 213.81           |
| FB     | 152.08           |
| GOOG   | 953.77           |
| INTC   | 35.17            |
| KO     | 45.36            |
| MSFT   | 70.52            |
| NFLX   | 156.51           |
| NKE    | 53.22            |
| NVDA   | 151.22           |
| PEP    | 116.78           |
| WFM    | 38.88            |
| WMT    | 77.55            |

## Forget APNSI, I only care about AMFANG's June 2017 average closing price ##

Apple, Microsoft, Facebook, Amazon, Netflix and Google (aka Alphabet) lets me contrive an excuse to practice writing a correlated subquery and common table expression.

```SQL
WITH amfang AS (
  SELECT id, symbol
  FROM
    stock.ticker
  WHERE symbol IN (
    'AAPL',
    'MSFT',
    'FB',
    'AMZN',
    'NFLX',
    'GOOG'
  )
)
SELECT amfang.symbol,
  (
    SELECT ROUND(AVG(h.close), 2)
    FROM
      stock.historical_data h
    WHERE
      h.date BETWEEN '2017-06-01' AND '2017-06-30' AND
      h.ticker=amfang.id
    GROUP BY h.ticker
  ) AS avg_close_201706
FROM
  amfang;
```

The **amfang** common table expression is used by the correlated subquery to calculate **avg_close_201706**.

| symbol | avg_close_201706 |
|:-------|:-----------------|
| AAPL   | 147.83           |
| AMZN   | 990.44           |
| FB     | 152.08           |
| MSFT   | 70.52            |
| GOOG   | 953.77           |
| NFLX   | 156.51           |

## The highest traded price and lowest traded price of the APNSI stocks that trade in the NYSE  ##

Instead of using a common table expression to generate the list of NYSE stocks, use a materialized view.

```SQL
CREATE MATERIALIZED VIEW stock.nyse_stock (
  ticker
) AS (
  SELECT t.id as ticker_id
  from stock.ticker t
  inner JOIN stock.exchange x on t.exchange = x.id
  where x.abbr='NYSE'
);
```
The ticker ids of nyse_stock are:

| ticker |
|:-------|
| 23     |
| 24     |
| 6      |
| 27     |
| 32     |
| 33     |

The highest traded price and lowest traded price:

```SQL
SELECT symbol, highest_price, lowest_price
FROM
  (
    SELECT
      ticker,
      MAX(high) AS highest_price,
      MIN(low)  AS lowest_price
    FROM
      stock.historical_data
    WHERE
      ticker IN (
        SELECT ticker
        FROM
          stock.nyse_stock
      )
    GROUP BY ticker
  ) nyse_hilo
    INNER JOIN
  stock.ticker t ON nyse_hilo.ticker = t.id
ORDER BY symbol;
```
| symbol | highest_price | lowest_price |
|:-------|:--------------|:-------------|
| BABA   | 148.29        | 79.24        |
| DPZ    | 221.58        | 134.22       |
| KO     | 46.06         | 39.88        |
| NKE    | 60.33         | 49.01        |
| PEP    | 118.24        | 98.5         |
| WMT    | 80.48         | 65.28        |

Domino's Pizza (DPZ) is included in the APNSI index  because according to [Quartz](https://qz.com/938620/dominos-dpz-stock-has-outperformed-google-goog-facebook-fb-apple-aapl-and-amazon-amzn-this-decade/), DPZ outperformed AFGA (Apple, Facebook, Google and Amazon) this decade.

Note: The data in the stock.historical_data table span from July 11, 2016 to July 7, 2011.


## A Window To Nike's Performance ##

In this section, I practice using SQL's window function dense_rank to rank Nike's performance by trading volume and then limiting the results to 23.

In my stock.ticker table, the id of Nike happened to be 23. What's the big deal with no. 23? Aside from 23 being a prime number, retired basketball player Michael Jordan wore no. 23 (yes, he did have a short fling with no.45). To those too young to know who Michael Jordan is, he is the name behind Nike's Jordan Brand.

Here is David Rubinstein's brief and terrific [interview](https://www.bloomberg.com/news/videos/2017-06-28/the-david-rubenstein-show-phil-knight-video) with Nike CEO Phil Knight.

```SQL
SELECT dense_rank() OVER (ORDER BY volume DESC) AS rank,
  date,
  volume,
  open,
  high,
  low,
  close
FROM
  stock.historical_data
WHERE
  ticker = 23
LIMIT 23;
```
| rank | date       | volume   | open  | high  | low   | close |
|:-----|:-----------|:---------|:------|:------|:------|:------|
| 1    | 2017-06-30 | 46552954 | 56.60 | 59.71 | 56.50 | 59.00 |
| 2    | 2017-03-22 | 37413372 | 54.76 | 55.00 | 53.76 | 53.92 |
| 3    | 2016-09-28 | 33213008 | 54.60 | 55.00 | 52.80 | 53.25 |
| 4    | 2017-06-16 | 25725453 | 51.75 | 51.84 | 50.79 | 51.10 |
| 5    | 2017-03-23 | 23848344 | 54.61 | 55.55 | 54.52 | 55.37 |
| 6    | 2016-12-21 | 23236380 | 52.90 | 53.35 | 51.55 | 52.30 |
| 7    | 2017-05-18 | 22576489 | 51.97 | 52.08 | 51.30 | 51.68 |
| 8    | 2017-05-19 | 20047766 | 51.00 | 52.11 | 50.81 | 51.77 |
| 9    | 2017-06-02 | 18511169 | 52.70 | 53.01 | 52.36 | 52.98 |
| 10   | 2017-05-17 | 18341473 | 52.39 | 52.87 | 51.80 | 51.80 |
| 11   | 2016-09-27 | 17945212 | 54.25 | 55.54 | 53.90 | 55.34 |
| 12   | 2016-10-31 | 17931262 | 50.88 | 51.15 | 50.00 | 50.18 |
| 13   | 2016-09-29 | 16993949 | 52.92 | 53.58 | 52.12 | 52.16 |
| 14   | 2017-07-05 | 16166954 | 58.24 | 58.29 | 57.51 | 57.56 |
| 15   | 2017-06-15 | 16041068 | 54.00 | 54.05 | 52.73 | 52.90 |
| 16   | 2016-08-19 | 15987096 | 57.40 | 59.14 | 57.25 | 58.90 |
| 17   | 2016-12-20 | 15984083 | 51.06 | 51.99 | 50.75 | 51.79 |
| 18   | 2017-03-21 | 15269827 | 58.78 | 59.00 | 57.72 | 58.01 |
| 19   | 2016-10-25 | 14975302 | 50.97 | 51.44 | 50.71 | 51.05 |
| 20   | 2017-02-10 | 14973383 | 55.63 | 56.47 | 55.63 | 56.22 |
| 21   | 2017-06-29 | 14801866 | 53.33 | 53.63 | 52.99 | 53.17 |
| 22   | 2017-05-16 | 14562678 | 52.37 | 53.38 | 52.12 | 52.78 |
| 23   | 2017-03-24 | 14438573 | 55.29 | 56.64 | 55.12 | 56.36 |

Since the likelihood of getting ties on Nike's trading volume seems small, I could have just used the window function **row** instead of **dense_rank** to associate each resulting row with an ordinal number. SQL has another ranking window function called **rank**.

Check out programmerinterview.com's  [blog](http://www.programmerinterview.com/index.php/database-sql/rank-versus-dense_rank/) for an  explanation  on the difference between **rank** and **dense_rank**.

## The historical data of each APSNI company's ten-lowest ranked closing days ##

It is time to add a tiny bit of complexity to the use of the window function dense_rank. Ties in ranked closing price can appear and will be treated as having the same rank, so **dense_rank** is used.

```SQL
SELECT symbol, date, volume, open, high, low, close, ranking
FROM
  (
    SELECT
      ticker,
      date,
      volume,
      open,
      high,
      low,
      close,
      dense_rank() OVER (PARTITION BY ticker ORDER BY close) AS ranking
    FROM
      stock.historical_data
  ) AS low_10_close
    INNER JOIN
  stock.ticker t ON  low_10_close.ticker = t.id
WHERE ranking <= 10
ORDER BY symbol, ranking, date DESC;
```

low_10_close generates rankings by closing price of each company's daily stock information from July 11, 2016 to July 7, 2017.

Below are the results of each company's ten lowest-ranked closing price days. BABA, FB, KO, PEP, WFM and WMT have more than 10 days of data because of tied rankings. The tied rankings are due to these companies having days with the  closing price.

| symbol | date       | volume    | open   | high   | low    | close  | ranking |
|:-------|:-----------|:----------|:-------|:-------|:-------|:-------|:--------|
| AAPL   | 2016-07-26 | 56239822  | 96.82  | 97.97  | 96.42  | 96.67  | 1       |
| AAPL   | 2016-07-13 | 25892171  | 97.41  | 97.67  | 96.84  | 96.87  | 2       |
| AAPL   | 2016-07-11 | 23794945  | 96.75  | 97.65  | 96.73  | 96.98  | 3       |
| AAPL   | 2016-07-25 | 40382921  | 98.25  | 98.84  | 96.92  | 97.34  | 4       |
| AAPL   | 2016-07-12 | 24167463  | 97.17  | 97.70  | 97.12  | 97.42  | 5       |
| AAPL   | 2016-07-22 | 28313669  | 99.26  | 99.30  | 98.31  | 98.66  | 6       |
| AAPL   | 2016-07-15 | 30136990  | 98.92  | 99.30  | 98.50  | 98.78  | 7       |
| AAPL   | 2016-07-14 | 38918997  | 97.39  | 98.99  | 97.32  | 98.79  | 8       |
| AAPL   | 2016-07-21 | 32702028  | 99.83  | 101.00 | 99.13  | 99.43  | 9       |
| AAPL   | 2016-07-18 | 36493867  | 98.70  | 100.13 | 98.60  | 99.83  | 10      |
| AMD    | 2016-07-11 | 21027948  | 5.13   | 5.19   | 5.00   | 5.01   | 1       |
| AMD    | 2016-07-13 | 14032518  | 5.14   | 5.19   | 5.04   | 5.09   | 2       |
| AMD    | 2016-07-15 | 14219263  | 5.20   | 5.20   | 5.10   | 5.14   | 3       |
| AMD    | 2016-07-12 | 20832476  | 5.01   | 5.17   | 5.01   | 5.14   | 3       |
| AMD    | 2016-07-14 | 20050141  | 5.15   | 5.24   | 5.06   | 5.17   | 4       |
| AMD    | 2016-07-21 | 40242023  | 5.43   | 5.45   | 5.10   | 5.22   | 5       |
| AMD    | 2016-07-20 | 20102373  | 5.48   | 5.50   | 5.40   | 5.41   | 6       |
| AMD    | 2016-07-19 | 23439607  | 5.50   | 5.55   | 5.34   | 5.41   | 6       |
| AMD    | 2016-07-18 | 38619404  | 5.19   | 5.57   | 5.13   | 5.51   | 7       |
| AMD    | 2016-09-13 | 50819506  | 5.92   | 5.95   | 5.66   | 5.74   | 8       |
| AMD    | 2016-07-22 | 101838278 | 5.73   | 5.97   | 5.45   | 5.84   | 9       |
| AMD    | 2016-09-09 | 170828036 | 6.23   | 6.24   | 5.85   | 5.90   | 10      |
| AMZN   | 2016-11-14 | 7321344   | 745.51 | 746.00 | 710.10 | 719.07 | 1       |
| AMZN   | 2016-07-15 | 3121385   | 746.55 | 746.55 | 734.05 | 735.44 | 2       |
| AMZN   | 2016-07-26 | 2529692   | 742.71 | 743.13 | 732.75 | 735.59 | 3       |
| AMZN   | 2016-07-18 | 2954914   | 735.49 | 741.60 | 728.72 | 736.07 | 4       |
| AMZN   | 2016-07-27 | 2913134   | 737.97 | 740.94 | 733.86 | 736.67 | 5       |
| AMZN   | 2016-11-11 | 6622784   | 735.73 | 743.26 | 728.90 | 739.01 | 6       |
| AMZN   | 2016-07-25 | 2679290   | 746.55 | 748.50 | 735.35 | 739.61 | 7       |
| AMZN   | 2016-07-19 | 2216820   | 732.50 | 743.33 | 732.31 | 739.95 | 8       |
| AMZN   | 2016-12-02 | 3561307   | 743.40 | 748.49 | 736.70 | 740.34 | 9       |
| AMZN   | 2016-07-14 | 2390472   | 748.86 | 749.04 | 739.02 | 741.20 | 10      |
| BABA   | 2016-07-13 | 10739182  | 81.83  | 81.88  | 80.37  | 80.57  | 1       |
| BABA   | 2016-07-15 | 8919868   | 81.78  | 82.49  | 80.96  | 81.25  | 2       |
| BABA   | 2016-07-11 | 17417457  | 79.33  | 81.90  | 79.24  | 81.46  | 3       |
| BABA   | 2016-07-14 | 9361454   | 81.18  | 82.24  | 80.86  | 81.74  | 4       |
| BABA   | 2016-07-12 | 15294115  | 81.79  | 82.88  | 81.51  | 81.74  | 4       |
| BABA   | 2016-07-29 | 8709279   | 83.37  | 83.42  | 81.94  | 82.48  | 5       |
| BABA   | 2016-07-18 | 12113575  | 80.60  | 82.79  | 80.60  | 82.65  | 6       |
| BABA   | 2016-07-19 | 9799375   | 82.48  | 83.69  | 82.05  | 82.77  | 7       |
| BABA   | 2016-07-27 | 11628979  | 83.60  | 83.64  | 83.00  | 83.10  | 8       |
| BABA   | 2016-07-28 | 7476531   | 83.46  | 83.49  | 82.12  | 83.12  | 9       |
| BABA   | 2016-07-25 | 13185912  | 84.47  | 84.79  | 82.61  | 83.19  | 10      |
| COST   | 2016-11-04 | 2702134   | 143.00 | 145.00 | 142.11 | 142.24 | 1       |
| COST   | 2016-11-07 | 3010110   | 143.38 | 143.66 | 142.75 | 143.54 | 2       |
| COST   | 2016-11-03 | 2168211   | 146.70 | 146.70 | 144.14 | 144.45 | 3       |
| COST   | 2016-11-08 | 3506032   | 143.89 | 146.63 | 143.80 | 146.09 | 4       |
| COST   | 2016-11-02 | 2260450   | 146.43 | 147.34 | 146.12 | 146.27 | 5       |
| COST   | 2016-11-01 | 2112003   | 148.48 | 148.63 | 146.38 | 146.66 | 6       |
| COST   | 2016-11-10 | 3944245   | 147.06 | 150.00 | 146.61 | 146.70 | 7       |
| COST   | 2016-11-09 | 3170343   | 143.54 | 147.39 | 143.54 | 146.79 | 8       |
| COST   | 2016-09-29 | 4501330   | 149.19 | 149.69 | 147.20 | 147.49 | 9       |
| COST   | 2016-10-31 | 3239395   | 148.89 | 149.35 | 147.10 | 147.87 | 10      |
| DPZ    | 2016-07-13 | 582183    | 135.24 | 136.37 | 135.00 | 135.42 | 1       |
| DPZ    | 2016-07-19 | 743973    | 135.93 | 136.18 | 135.09 | 135.55 | 2       |
| DPZ    | 2016-07-18 | 555604    | 135.97 | 136.18 | 134.78 | 135.55 | 2       |
| DPZ    | 2016-07-14 | 506422    | 136.32 | 136.66 | 135.22 | 135.64 | 3       |
| DPZ    | 2016-07-12 | 641317    | 136.04 | 136.47 | 135.50 | 135.65 | 4       |
| DPZ    | 2016-07-15 | 666637    | 135.88 | 136.27 | 134.92 | 135.70 | 5       |
| DPZ    | 2016-07-11 | 950544    | 135.59 | 136.15 | 134.22 | 136.00 | 6       |
| DPZ    | 2016-07-20 | 1332607   | 136.30 | 137.87 | 135.80 | 136.89 | 7       |
| DPZ    | 2016-08-16 | 349488    | 145.08 | 145.59 | 143.53 | 143.97 | 8       |
| DPZ    | 2016-08-17 | 327876    | 144.20 | 144.68 | 143.47 | 144.57 | 9       |
| DPZ    | 2016-07-21 | 3247031   | 144.94 | 146.73 | 142.06 | 144.66 | 10      |
| FB     | 2016-12-30 | 18684106  | 116.60 | 116.83 | 114.77 | 115.05 | 1       |
| FB     | 2016-11-14 | 51377040  | 119.13 | 119.13 | 113.55 | 115.08 | 2       |
| FB     | 2016-12-01 | 43276994  | 118.38 | 118.45 | 114.00 | 115.10 | 3       |
| FB     | 2016-12-02 | 25070364  | 115.11 | 116.48 | 114.30 | 115.40 | 4       |
| FB     | 2016-11-16 | 32397947  | 114.48 | 117.88 | 114.21 | 116.34 | 5       |
| FB     | 2016-12-29 | 9934873   | 117.00 | 117.53 | 116.06 | 116.35 | 6       |
| FB     | 2016-07-13 | 16207662  | 118.39 | 118.40 | 116.68 | 116.78 | 7       |
| FB     | 2017-01-03 | 20663912  | 116.03 | 117.84 | 115.51 | 116.86 | 8       |
| FB     | 2016-07-15 | 16645964  | 117.74 | 118.28 | 116.58 | 116.86 | 8       |
| FB     | 2016-12-28 | 12087377  | 118.19 | 118.25 | 116.65 | 116.92 | 9       |
| FB     | 2016-11-18 | 22879303  | 118.39 | 119.13 | 116.84 | 117.02 | 10      |
| GOOG   | 2016-07-11 | 1111762   | 708.05 | 716.51 | 707.24 | 715.09 | 1       |
| GOOG   | 2016-07-13 | 935876    | 723.62 | 724.00 | 716.85 | 716.98 | 2       |
| GOOG   | 2016-07-15 | 1279339   | 725.73 | 725.74 | 719.06 | 719.85 | 3       |
| GOOG   | 2016-07-12 | 1336921   | 719.12 | 722.94 | 715.91 | 720.64 | 4       |
| GOOG   | 2016-07-14 | 950193    | 721.58 | 722.21 | 718.03 | 720.95 | 5       |
| GOOG   | 2016-07-18 | 1295476   | 722.71 | 736.13 | 721.19 | 733.78 | 6       |
| GOOG   | 2016-11-14 | 3654385   | 755.60 | 757.85 | 727.54 | 736.08 | 7       |
| GOOG   | 2016-07-19 | 1227486   | 729.89 | 736.99 | 729.00 | 736.96 | 8       |
| GOOG   | 2016-07-26 | 1186738   | 739.04 | 741.69 | 734.27 | 738.42 | 9       |
| GOOG   | 2016-07-21 | 1026306   | 740.36 | 741.69 | 735.83 | 738.63 | 10      |
| INTC   | 2017-07-03 | 12676894  | 33.51  | 34.03  | 33.43  | 33.46  | 1       |
| INTC   | 2017-06-29 | 25215664  | 33.92  | 34.10  | 33.34  | 33.54  | 2       |
| INTC   | 2016-11-04 | 21914746  | 33.53  | 33.93  | 33.42  | 33.61  | 3       |
| INTC   | 2017-07-06 | 20733189  | 34.12  | 34.29  | 33.56  | 33.63  | 4       |
| INTC   | 2017-06-27 | 27078918  | 34.00  | 34.14  | 33.65  | 33.65  | 5       |
| INTC   | 2017-06-30 | 24432020  | 33.87  | 33.93  | 33.54  | 33.74  | 6       |
| INTC   | 2016-12-01 | 29618687  | 34.86  | 34.93  | 33.56  | 33.76  | 7       |
| INTC   | 2017-07-07 | 18304460  | 33.70  | 34.12  | 33.70  | 33.88  | 8       |
| INTC   | 2016-11-03 | 19400032  | 34.45  | 34.52  | 33.87  | 33.93  | 9       |
| INTC   | 2017-06-26 | 18854766  | 34.26  | 34.51  | 34.03  | 34.07  | 10      |
| KO     | 2016-12-01 | 20409864  | 40.31  | 40.39  | 39.88  | 40.17  | 1       |
| KO     | 2016-11-30 | 22410367  | 41.00  | 41.20  | 40.35  | 40.35  | 2       |
| KO     | 2016-12-02 | 11176301  | 40.30  | 40.50  | 40.19  | 40.36  | 3       |
| KO     | 2017-02-15 | 26600788  | 40.42  | 40.63  | 40.40  | 40.44  | 4       |
| KO     | 2017-02-14 | 32177836  | 40.38  | 40.60  | 40.22  | 40.53  | 5       |
| KO     | 2016-12-06 | 11303492  | 40.75  | 40.77  | 40.42  | 40.57  | 6       |
| KO     | 2017-02-10 | 28847307  | 41.02  | 41.20  | 40.55  | 40.58  | 7       |
| KO     | 2017-02-13 | 23617075  | 40.77  | 40.83  | 40.50  | 40.62  | 8       |
| KO     | 2016-12-05 | 15977847  | 40.34  | 40.69  | 40.31  | 40.62  | 8       |
| KO     | 2017-01-13 | 8123494   | 41.00  | 41.04  | 40.69  | 40.88  | 9       |
| KO     | 2016-11-18 | 16345262  | 41.03  | 41.20  | 40.90  | 40.91  | 10      |
| MSFT   | 2016-07-11 | 22269203  | 52.50  | 52.83  | 52.47  | 52.59  | 1       |
| MSFT   | 2016-07-19 | 53336533  | 53.71  | 53.90  | 52.93  | 53.09  | 2       |
| MSFT   | 2016-07-12 | 27317555  | 52.94  | 53.40  | 52.78  | 53.21  | 3       |
| MSFT   | 2016-07-13 | 25356841  | 53.56  | 53.86  | 53.18  | 53.51  | 4       |
| MSFT   | 2016-07-15 | 32024385  | 53.95  | 54.00  | 53.21  | 53.70  | 5       |
| MSFT   | 2016-07-14 | 24545520  | 53.84  | 53.99  | 53.58  | 53.74  | 6       |
| MSFT   | 2016-07-18 | 31433864  | 53.70  | 54.34  | 53.55  | 53.96  | 7       |
| MSFT   | 2016-07-21 | 32776653  | 55.98  | 56.23  | 55.76  | 55.80  | 8       |
| MSFT   | 2016-07-20 | 89893301  | 56.15  | 56.84  | 55.53  | 55.91  | 9       |
| MSFT   | 2016-07-27 | 32327477  | 56.61  | 56.80  | 56.11  | 56.19  | 10      |
| NFLX   | 2016-07-19 | 55681209  | 85.43  | 86.75  | 84.50  | 85.84  | 1       |
| NFLX   | 2016-07-22 | 11363917  | 86.48  | 86.50  | 85.11  | 85.89  | 2       |
| NFLX   | 2016-07-21 | 16083996  | 88.30  | 88.38  | 85.21  | 85.99  | 3       |
| NFLX   | 2016-07-25 | 14135027  | 85.73  | 87.87  | 85.01  | 87.66  | 4       |
| NFLX   | 2016-07-20 | 23525141  | 86.67  | 88.49  | 85.82  | 87.91  | 5       |
| NFLX   | 2016-07-29 | 6960222   | 91.19  | 91.75  | 90.59  | 91.25  | 6       |
| NFLX   | 2016-07-26 | 19577623  | 91.03  | 93.10  | 90.90  | 91.41  | 7       |
| NFLX   | 2016-07-28 | 6227698   | 91.92  | 92.21  | 90.68  | 91.65  | 8       |
| NFLX   | 2016-07-27 | 8727517   | 91.50  | 92.06  | 90.10  | 92.04  | 9       |
| NFLX   | 2016-08-03 | 7030916   | 93.28  | 94.67  | 92.55  | 93.10  | 10      |
| NKE    | 2016-11-01 | 14100431  | 50.50  | 50.51  | 49.14  | 49.62  | 1       |
| NKE    | 2016-11-02 | 10775938  | 49.24  | 50.27  | 49.01  | 49.72  | 2       |
| NKE    | 2016-11-03 | 7678690   | 49.98  | 50.00  | 49.31  | 49.73  | 3       |
| NKE    | 2016-11-04 | 9925196   | 49.80  | 50.45  | 49.76  | 49.96  | 4       |
| NKE    | 2016-11-30 | 8198418   | 50.52  | 50.81  | 50.07  | 50.07  | 5       |
| NKE    | 2016-11-15 | 9299754   | 50.46  | 50.64  | 49.75  | 50.13  | 6       |
| NKE    | 2016-10-31 | 17931262  | 50.88  | 51.15  | 50.00  | 50.18  | 7       |
| NKE    | 2016-11-14 | 8063943   | 51.18  | 51.19  | 50.21  | 50.21  | 8       |
| NKE    | 2016-11-10 | 12316075  | 51.29  | 51.37  | 50.33  | 50.39  | 9       |
| NKE    | 2016-12-02 | 6933279   | 50.26  | 50.68  | 50.10  | 50.46  | 10      |
| NVDA   | 2016-07-11 | 11219437  | 51.58  | 52.40  | 51.52  | 52.02  | 1       |
| NVDA   | 2016-07-15 | 10715357  | 52.64  | 52.94  | 51.84  | 52.70  | 2       |
| NVDA   | 2016-07-13 | 8115130   | 52.90  | 53.20  | 52.70  | 52.78  | 3       |
| NVDA   | 2016-07-12 | 10919045  | 52.60  | 53.28  | 51.94  | 52.80  | 4       |
| NVDA   | 2016-07-18 | 6324838   | 53.35  | 53.43  | 52.77  | 52.97  | 5       |
| NVDA   | 2016-07-21 | 9032697   | 54.10  | 54.27  | 53.04  | 53.22  | 6       |
| NVDA   | 2016-07-14 | 7922283   | 53.06  | 53.80  | 52.62  | 53.32  | 7       |
| NVDA   | 2016-07-19 | 9566250   | 52.94  | 53.73  | 52.84  | 53.52  | 8       |
| NVDA   | 2016-07-20 | 7411502   | 53.70  | 54.50  | 53.48  | 54.22  | 9       |
| NVDA   | 2016-07-22 | 7894165   | 53.41  | 54.67  | 53.02  | 54.67  | 10      |
| PEP    | 2016-12-01 | 7123022   | 99.89  | 100.05 | 98.50  | 99.03  | 1       |
| PEP    | 2016-11-30 | 8123491   | 101.51 | 101.92 | 100.10 | 100.10 | 2       |
| PEP    | 2016-12-02 | 4594602   | 99.40  | 100.64 | 99.40  | 100.60 | 3       |
| PEP    | 2016-12-05 | 3961810   | 100.62 | 100.91 | 100.12 | 100.71 | 4       |
| PEP    | 2016-11-18 | 4919150   | 101.40 | 101.80 | 101.18 | 101.31 | 5       |
| PEP    | 2016-11-14 | 7248755   | 102.86 | 103.34 | 100.45 | 101.39 | 6       |
| PEP    | 2016-11-23 | 4676147   | 102.52 | 102.89 | 101.46 | 101.53 | 7       |
| PEP    | 2017-01-13 | 3478642   | 101.88 | 102.11 | 101.22 | 101.55 | 8       |
| PEP    | 2016-12-06 | 4828363   | 101.08 | 101.61 | 100.80 | 101.55 | 8       |
| PEP    | 2016-11-17 | 4178331   | 101.81 | 101.93 | 101.18 | 101.62 | 9       |
| PEP    | 2016-11-16 | 3962938   | 102.36 | 102.90 | 101.47 | 101.71 | 10      |
| WFM    | 2016-10-05 | 7863408   | 28.07  | 28.19  | 27.91  | 27.96  | 1       |
| WFM    | 2016-09-14 | 4827056   | 27.86  | 28.20  | 27.67  | 28.00  | 2       |
| WFM    | 2016-09-13 | 5231731   | 28.23  | 28.38  | 27.81  | 28.00  | 2       |
| WFM    | 2016-09-29 | 3234479   | 28.32  | 28.35  | 27.99  | 28.01  | 3       |
| WFM    | 2016-10-04 | 3714844   | 28.28  | 28.55  | 28.00  | 28.03  | 4       |
| WFM    | 2016-10-21 | 3790306   | 28.26  | 28.45  | 28.00  | 28.08  | 5       |
| WFM    | 2016-10-18 | 2151911   | 28.47  | 28.58  | 28.18  | 28.21  | 6       |
| WFM    | 2016-10-03 | 3278657   | 28.37  | 28.52  | 28.02  | 28.21  | 6       |
| WFM    | 2016-09-20 | 3883763   | 28.60  | 28.74  | 28.21  | 28.22  | 7       |
| WFM    | 2016-10-24 | 2986248   | 28.20  | 28.54  | 28.12  | 28.27  | 8       |
| WFM    | 2016-10-31 | 4692277   | 28.76  | 28.84  | 28.03  | 28.29  | 9       |
| WFM    | 2016-10-27 | 2499115   | 28.43  | 28.58  | 28.23  | 28.29  | 9       |
| WFM    | 2016-10-20 | 5520464   | 28.96  | 28.97  | 28.01  | 28.29  | 9       |
| WFM    | 2016-10-17 | 3633975   | 28.81  | 28.91  | 28.28  | 28.31  | 10      |
| WMT    | 2017-01-27 | 13433629  | 66.86  | 66.97  | 65.28  | 65.66  | 1       |
| WMT    | 2017-02-01 | 9049972   | 66.46  | 66.71  | 66.04  | 66.23  | 2       |
| WMT    | 2017-02-06 | 9097238   | 66.37  | 66.86  | 66.37  | 66.40  | 3       |
| WMT    | 2017-01-30 | 8641511   | 65.63  | 66.48  | 65.63  | 66.42  | 4       |
| WMT    | 2017-02-03 | 7625330   | 66.82  | 66.93  | 66.44  | 66.50  | 5       |
| WMT    | 2017-01-23 | 7951427   | 67.01  | 67.18  | 66.56  | 66.65  | 6       |
| WMT    | 2017-02-02 | 8998739   | 66.34  | 67.14  | 66.34  | 66.70  | 7       |
| WMT    | 2017-01-26 | 6504073   | 67.13  | 67.22  | 66.62  | 66.73  | 8       |
| WMT    | 2017-01-31 | 9320880   | 66.21  | 66.89  | 65.88  | 66.74  | 9       |
| WMT    | 2017-02-07 | 5805722   | 66.56  | 67.00  | 66.51  | 66.89  | 10      |
| WMT    | 2017-01-25 | 8722855   | 67.52  | 67.73  | 66.79  | 66.89  | 10      |
